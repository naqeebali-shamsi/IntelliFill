---
phase: 07-marketing-site
plan: 03
type: execute
wave: 2
depends_on: ["07-02"]
files_modified:
  - vercel.json
  - marketing/vercel.json
autonomous: false
---

<objective>
Configure Vercel for multi-project deployment with separate domains for marketing and app.

Purpose: Marketing site at intellifill.com, application at app.intellifill.com. Both deploy from the same repository.
Output: Working Vercel configuration with both domains functional.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Marketing site from Plan 02
@marketing/astro.config.mjs
@marketing/package.json

# Existing app structure
@quikadmin-web/package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure Vercel for monorepo multi-project deployment</name>
  <files>vercel.json, marketing/vercel.json</files>
  <action>
    Set up Vercel configuration for multi-project deployment:

    **Option A: Two Vercel Projects (Recommended)**

    This approach creates two separate Vercel projects from the same repo:
    1. `intellifill-app` - deploys quikadmin-web to app.intellifill.com
    2. `intellifill-marketing` - deploys marketing to intellifill.com

    Steps:

    1. **Create marketing/vercel.json**:
       ```json
       {
         "$schema": "https://openapi.vercel.sh/vercel.json",
         "buildCommand": "npm run build",
         "outputDirectory": "dist",
         "framework": "astro",
         "installCommand": "npm install"
       }
       ```

    2. **Create/update root vercel.json** for app deployment:
       ```json
       {
         "$schema": "https://openapi.vercel.sh/vercel.json",
         "buildCommand": "cd quikadmin-web && bun install && bun run build",
         "outputDirectory": "quikadmin-web/dist",
         "framework": "vite",
         "installCommand": "npm install -g bun && bun install"
       }
       ```

    3. **Document deployment steps** in marketing/README.md:
       ```markdown
       # IntelliFill Marketing Site

       ## Deployment

       This site deploys to intellifill.com via Vercel.

       ### Initial Setup (one-time)

       1. Go to vercel.com/new
       2. Import this repository
       3. Set Root Directory to `marketing`
       4. Framework: Astro
       5. Deploy

       ### Domain Configuration

       1. Go to Project Settings → Domains
       2. Add `intellifill.com` as the primary domain
       3. Add `www.intellifill.com` with redirect to intellifill.com

       ### Environment Variables

       None required for marketing site.
       ```

    4. **Update .gitignore** if needed:
       ```
       # Marketing site
       marketing/node_modules/
       marketing/dist/
       marketing/.astro/
       ```

    Note: The actual Vercel project creation happens in the dashboard, but we prepare all config files.
  </action>
  <verify>
    - marketing/vercel.json exists with correct config
    - vercel.json exists at root with app config
    - marketing/README.md has deployment instructions
  </verify>
  <done>
    Vercel configuration files created for both projects. Documentation ready for deployment.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Vercel configuration for multi-domain deployment:
    - Marketing site config in marketing/vercel.json
    - App config in root vercel.json
    - Deployment documentation in marketing/README.md
  </what-built>
  <how-to-verify>
    **For Marketing Site (intellifill.com):**

    1. Go to https://vercel.com/new
    2. Import the IntelliFill repository
    3. Set Root Directory to `marketing`
    4. Framework preset: Astro
    5. Click Deploy
    6. After deploy, go to Settings → Domains
    7. Add your domain (intellifill.com or a test subdomain)
    8. Verify the site loads with hero, features, pricing

    **For App (app.intellifill.com):**

    If the app is already deployed:
    1. Go to existing Vercel project settings
    2. Verify domain is app.intellifill.com (or add it)
    3. Verify app still works after any config changes

    If not yet deployed:
    1. Create another Vercel project for the app
    2. Root Directory: `.` (root)
    3. Build Command: `cd quikadmin-web && bun install && bun run build`
    4. Output Directory: `quikadmin-web/dist`
    5. Add app.intellifill.com domain

    **Cross-link verification:**
    - Marketing site "Get Started" button → app.intellifill.com/register
    - Marketing site "Login" link → app.intellifill.com/login
    - App login page → clean, no marketing content
  </how-to-verify>
  <resume-signal>
    Type "approved" when both sites are deployed and domains work correctly, or describe any issues encountered.
  </resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] marketing/vercel.json configured correctly
- [ ] Root vercel.json configured for app deployment
- [ ] Both Vercel projects created (if not already)
- [ ] Domains configured: intellifill.com and app.intellifill.com
- [ ] Marketing site loads at intellifill.com
- [ ] App loads at app.intellifill.com
- [ ] Cross-links between sites work
</verification>

<success_criteria>
- All tasks completed
- User verified deployment works
- Marketing site accessible at root domain
- App accessible at app subdomain
- No broken links between sites
- Phase 7 complete
</success_criteria>

<output>
After completion, create `.planning/phases/07-marketing-site/07-03-SUMMARY.md`
</output>
