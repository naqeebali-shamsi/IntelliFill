---
phase: 01-foundation
plan: 06
type: execute
---

<objective>
Fix misleading confidence UI and add proper extraction progress feedback.

Purpose: Address AI UX issues where "Verified" badge at 85% misleads users into trusting uncertain data.
Output: Accurate confidence presentation and meaningful progress indicators during extraction.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-05-SUMMARY.md

**Files to modify:**
@quikadmin-web/src/components/smart-profile/ConfidenceBadge.tsx
@quikadmin-web/src/components/smart-profile/ProfileView.tsx

**Expert Review Context (AI UX):**

- "Verified" label at 85% is misleading - users trust uncertain data
- No extraction progress detail - just spinner with no insight
- Confidence thresholds need clearer semantic meaning
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Fix confidence badge thresholds and labels</name>
  <files>quikadmin-web/src/components/smart-profile/ConfidenceBadge.tsx</files>
  <action>
Update ConfidenceBadge to use accurate, non-misleading labels:

1. Change threshold labels to be honest about uncertainty:

   ```typescript
   // OLD (misleading):
   // >= 0.85: "Verified" (users think it's 100% correct)

   // NEW (honest):
   const getConfidenceInfo = (confidence: number) => {
     if (confidence >= 0.95) {
       return { label: 'High confidence', variant: 'success', icon: CheckCircle };
     }
     if (confidence >= 0.85) {
       return { label: 'Good confidence', variant: 'success', icon: CheckCircle };
     }
     if (confidence >= 0.7) {
       return { label: 'Review suggested', variant: 'warning', icon: AlertCircle };
     }
     return { label: 'Low confidence', variant: 'error', icon: AlertTriangle };
   };
   ```

2. Add tooltip showing actual percentage:

   ```tsx
   <TooltipProvider>
     <Tooltip>
       <TooltipTrigger asChild>
         <Badge variant={variant} className={...}>
           <Icon className="h-3 w-3 mr-1" />
           {label}
         </Badge>
       </TooltipTrigger>
       <TooltipContent>
         {Math.round(confidence * 100)}% extraction confidence
       </TooltipContent>
     </Tooltip>
   </TooltipProvider>
   ```

3. Never use "Verified" - it implies human verification which didn't happen.

AVOID: "Verified", "Confirmed", "Accurate" - these overstate certainty.
WHY: Users skip review when they see "Verified", leading to form errors.
</action>
<verify>

1. Check ConfidenceBadge renders:
   - 95%+ → "High confidence" (green)
   - 85-94% → "Good confidence" (green)
   - 70-84% → "Review suggested" (yellow)
   - <70% → "Low confidence" (red)
2. Hover shows actual percentage in tooltip
3. No "Verified" text anywhere in component
   </verify>
   <done>

- Confidence labels are honest: "High/Good confidence", "Review suggested", "Low confidence"
- Tooltip shows actual percentage for transparency
- "Verified" removed entirely
- Users understand these are AI-extracted values, not human-verified
  </done>
  </task>

<task type="auto">
  <name>Task 2: Add extraction progress indicators</name>
  <files>quikadmin-web/src/components/smart-profile/ProfileView.tsx, quikadmin-web/src/stores/smartProfileStore.ts</files>
  <action>
Add meaningful progress feedback during extraction:

1. Add extraction progress state to store:

   ```typescript
   // In smartProfileStore.ts
   interface SmartProfileState {
     // ... existing fields
     extractionProgress: {
       status: 'idle' | 'extracting' | 'merging' | 'complete' | 'error';
       currentFile: string | null;
       processedCount: number;
       totalCount: number;
     };
   }
   ```

2. Update progress during extraction:

   ```typescript
   setExtractionProgress: (progress: Partial<ExtractionProgress>) =>
     set((state) => ({
       extractionProgress: { ...state.extractionProgress, ...progress },
     })),
   ```

3. In ProfileView or parent wizard, show progress during extraction:

   ```tsx
   {
     extractionProgress.status === 'extracting' && (
       <div className="flex flex-col items-center gap-2 py-8">
         <Loader2 className="h-8 w-8 animate-spin text-primary" />
         <p className="text-sm font-medium">Processing {extractionProgress.currentFile}...</p>
         <p className="text-xs text-muted-foreground">
           {extractionProgress.processedCount} of {extractionProgress.totalCount} documents
         </p>
         <Progress
           value={(extractionProgress.processedCount / extractionProgress.totalCount) * 100}
           className="w-48"
         />
       </div>
     );
   }
   ```

4. Show "Merging profile data..." after all files processed.

AVOID: Just a spinner with no context.
WHY: Users think app is frozen when processing takes 10+ seconds.
</action>
<verify>

1. Upload 3+ documents
2. During extraction, see:
   - Current file being processed
   - "X of Y documents" counter
   - Progress bar filling
   - "Merging profile data..." at end
3. Not just a spinner
   </verify>
   <done>

- Extraction shows current file name being processed
- Progress shows "X of Y documents"
- Visual progress bar tracks completion
- "Merging profile data..." appears after extraction
- Users understand what's happening during 10+ second operations
  </done>
  </task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `bun run build` in quikadmin-web succeeds without errors
- [ ] ConfidenceBadge shows "High/Good confidence" or "Review suggested" (not "Verified")
- [ ] Hover on badge shows actual percentage
- [ ] Extraction shows file name, progress count, and progress bar
- [ ] No "Verified" text in codebase: `grep -r "Verified" quikadmin-web/src/components/smart-profile/`
</verification>

<success_criteria>

- All 2 tasks completed and committed
- Confidence badges use honest labels (no "Verified")
- Tooltips show actual percentages
- Extraction progress shows current file and count
- Build passes, no TypeScript errors
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-06-SUMMARY.md`
</output>
