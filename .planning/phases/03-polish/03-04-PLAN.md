# Plan 03-04: UI Polish & Verification

**Phase:** 03-polish
**Wave:** 2
**Autonomous:** false

## Goal

Final polish pass integrating all Phase 3 features, performance measurement, and user verification checkpoint.

## Prerequisites

- Plan 03-01 complete (FormSuggester)
- Plan 03-02 complete (Wizard Animations)
- Plan 03-03 complete (Assisted/Express Mode)

## Tasks

### Task 1: Add performance logging

**Files:**

- `quikadmin-web/src/pages/SmartProfile.tsx` (modify)
- `quikadmin-web/src/lib/performance.ts` (new)

**Performance utility:**

```typescript
// Simple dev-mode timing utility
export function startTiming(label: string): () => void {
  if (import.meta.env.PROD) return () => {};
  const start = performance.now();
  return () => {
    const duration = performance.now() - start;
    console.log(`[Perf] ${label}: ${duration.toFixed(0)}ms`);
  };
}
```

**Timing markers:**

1. Document detection (upload → type detection complete)
2. Batch extraction (detection → extraction complete)
3. Total wizard time (upload → form selection complete)

**Integration points:**

- `onUpload` → start detection timer
- `detect-types` response → end detection, start extraction timer
- `extract-batch` response → end extraction timer
- Form selection complete → end total timer

### Task 2: Visual consistency pass

**Files:**

- Various SmartProfile components (audit and fix)

**Checklist:**

1. **Loading states:**
   - Upload zone: spinner during detection
   - Extraction: progress indicator with step info
   - Form suggestion: skeleton loaders while computing

2. **Empty states:**
   - No documents uploaded: clear call-to-action
   - No form suggestions: helpful message with document suggestions

3. **Error states:**
   - Detection failure: retry option
   - Extraction failure: partial results with warning

4. **Transitions:**
   - All step transitions use wizard-variants
   - No jarring layout shifts
   - Consistent timing across all steps

5. **Accessibility:**
   - All interactive elements keyboard accessible
   - Screen reader labels on badges and icons
   - Reduced motion respected everywhere

### Task 3: User verification checkpoint

**Checkpoint:** After visual consistency pass, before marking complete

**Verification script for user:**

1. Upload 2-3 documents (passport, emirates ID, utility bill)
2. Verify detection and extraction timing (<3s detection, <10s extraction)
3. Check person grouping (if multiple detected)
4. Review confidence badges and field sources
5. Test FormSuggester ranking
6. Toggle Assisted/Express mode
7. Verify auto-skip behavior matches mode
8. Complete wizard end-to-end
9. Test on mobile viewport (responsive)

**Expected outcomes:**

- Smooth animations throughout
- Correct form suggestions based on documents
- Mode toggle persists across refresh
- All steps accessible and usable

## Verification

- [ ] `bun run build` succeeds
- [ ] Performance logs show timing in dev console
- [ ] No visual glitches or layout shifts
- [ ] User verification checkpoint passed

## Commit Format

```
feat(03-04): {task-name}
```

---

_Plan created: 2026-01-16_
