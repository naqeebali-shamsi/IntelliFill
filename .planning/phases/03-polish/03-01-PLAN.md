# Plan 03-01: FormSuggester

**Phase:** 03-polish
**Wave:** 1
**Autonomous:** true

## Goal

Smart form suggestion based on uploaded documents. Users upload documents, and IntelliFill suggests which forms they can complete based on the document types detected.

## Prerequisites

- Phase 2 complete (entity resolution, confidence review, field sources)
- `form-fields.ts` exists with `FORM_REQUIRED_FIELDS` and `DOCUMENT_FIELD_SOURCES`

## Tasks

### Task 1: Add form mapping utilities

**Files:**

- `quikadmin-web/src/lib/form-fields.ts` (extend existing)

**Changes:**

1. Add `DOCUMENT_TO_FORM_MAPPING` - maps document types to forms they support
2. Add `suggestForms()` function - scores forms based on uploaded documents
3. Add `FormSuggestion` type - { formId, confidence, matchedDocuments, missingDocuments }

**Logic:**

```typescript
// For each uploaded document type, find which forms it helps complete
// Score = matchedDocuments / totalRequiredDocuments
// Sort by score descending
```

**Tests:** Unit tests for `suggestForms()` with various document combinations

### Task 2: Build FormSuggester UI components

**Files:**

- `quikadmin-web/src/components/smart-profile/FormSuggester/index.tsx` (new)
- `quikadmin-web/src/components/smart-profile/FormSuggester/FormCard.tsx` (new)

**FormCard props:**

- `form: FormSuggestion`
- `isSelected: boolean`
- `onSelect: () => void`

**FormCard displays:**

- Form name (from `getFormTypeLabel`)
- Confidence badge (matches existing confidence UI pattern)
- Matched documents count
- Missing fields alert (if any)

**FormSuggester props:**

- `documentTypes: string[]`
- `selectedFormId: string | null`
- `onSelectForm: (formId: string) => void`

**Behavior:**

- Uses `suggestForms()` to get ranked suggestions
- Renders FormCard for each suggestion
- Uses staggered animation (from existing `staggerContainer`)

### Task 3: Integrate FormSuggester into wizard

**Files:**

- `quikadmin-web/src/pages/SmartProfile.tsx` (modify)
- `quikadmin-web/src/stores/smartProfileStore.ts` (modify)

**Store changes:**

- Add `selectedFormId: string | null`
- Add `setSelectedFormId(formId: string)` action

**Wizard integration:**

- Replace current form-select step content with FormSuggester
- Pass detected document types from store
- Wire up form selection to store
- Update MissingFieldsAlert to use selected form (not hardcoded 'visa-application')

## Verification

- [ ] `bun run build` succeeds
- [ ] FormSuggester shows ranked forms based on uploaded documents
- [ ] Selecting a form updates MissingFieldsAlert
- [ ] Forms with higher coverage ranked first

## Commit Format

```
feat(03-01): {task-name}
```

---

_Plan created: 2026-01-16_
